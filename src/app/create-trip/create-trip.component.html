<div class="container mx-auto px-4 py-8">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div class="space-y-6">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4">Add Location</h2>
                <app-places-search (placeSelected)="onPlaceSelected($event)"></app-places-search>

                <div *ngIf="googleMapsLocation !== null"
                    class="mt-4 bg-blue-50 p-4 rounded-md border-l-4 border-blue-500">
                    <p class="my-1"><span class="font-bold">Name:</span> {{ googleMapsLocation.name }}</p>
                    <p class="my-1"><span class="font-bold">Address:</span> {{ googleMapsLocation.address }}</p>
                    <div class="relative h-32 mb-4 rounded-lg overflow-hidden">
                        <img #tripImageEl [src]="googleMapsLocation.image" [alt]="googleMapsLocation.name"
                            class="w-full h-full object-cover">
                    </div>
                </div>

                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Duration of Stay</label>
                    <select #durationInput
                        class="w-full p-2 rounded-md border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="" disabled selected>Select duration</option>
                        <option *ngFor="let i of [1,2,3,4,5,6,7,8,9,10]" [value]="i">{{i}} {{i === 1 ? 'day' : 'days'}}
                        </option>
                    </select>
                </div>

                <button
                    class="w-full btn btn-blue mt-4"
                    (click)="onAddLocationToTrip()">
                    Add Location to Trip
                </button>
            </div>
        </div>

        <div *ngIf="places && places.length > 0" class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-semibold mb-4">Trip Details</h2>

            <!-- Trip Information -->
            <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                <h3 class="text-lg font-medium text-gray-900 mb-4">Trip Information</h3>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Trip Title</label>
                        <input type="text"
                            class="w-full p-2 rounded-md border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            placeholder="e.g., Summer European Adventure" #titleInput>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Trip Description</label>
                        <textarea
                            class="w-full p-2 rounded-md border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            placeholder="Describe your trip..." rows="3" #descriptionInput></textarea>
                    </div>
                </div>
            </div>

            <!-- Itinerary -->
            <div class="mb-6">
                <h3 class="text-lg font-medium text-gray-900 mb-4">Itinerary</h3>

                <div cdkListGroup class="space-y-4">
                    <div cdkDropList [cdkDropListData]="places" (cdkDropListDropped)="drop($event)" class="flex flex-col gap-4">
                        <div cdkDrag *ngFor="let stop of places; let i = index" [id]="'stop-' + i"
                            class="flex items-center p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200">
                            <div cdkDragHandle class="cursor-move text-gray-400 hover:text-gray-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8"
                                    matTooltip="Drag and drop stop to change order" matTooltipPosition="above"
                                    fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M4 8h16M4 16h16" />
                                </svg>
                            </div>
                            <div
                                class="ml-4 flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-semibold">
                                {{ i + 1 }}
                            </div>
                            <div class="ml-4 flex-grow">
                                <h3 class="font-medium text-gray-900">{{stop.location.name}}</h3>
                                <p class="text-sm text-gray-600">{{stop.location.address}}</p>
                            </div>
                            <div class="ml-4">
                                <span
                                    class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">
                                    {{stop.duration}} days
                                </span>
                            </div>
                            <div class="ml-4">
                                <button type="button"
                                    class="w-10 h-10 btn btn-red-light !p-0 !rounded-full"
                                    (click)="onDeleteStopFromTrip(i)" aria-label="Delete stop">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                                        stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <button
                class="w-full btn btn-green mt-4"
                (click)="onAddTripToTripList()">
                {{ saveButtonText }}
            </button>
        </div>
    </div>
</div>
